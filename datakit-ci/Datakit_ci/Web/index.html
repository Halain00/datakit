<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Web (datakit-ci.Datakit_ci.Web)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">datakit-ci</a> &#x00BB; <a href="../index.html">Datakit_ci</a> &#x00BB; Web</nav><h1>Module <code>Datakit_ci.Web</code></h1><nav class="toc"><ul><li><a href="#web">Web Configuration</a></li></ul></nav></header><section><header><h2 id="web"><a href="#web" class="anchor"></a>Web Configuration</h2></header><dl><dt class="spec type" id="type-config"><a href="#type-config" class="anchor"></a><code><span class="keyword">type</span> config</code></dt><dd><p>The type for web configuration.</p></dd></dl><dl><dt class="spec value" id="val-config"><a href="#val-config" class="anchor"></a><code><span class="keyword">val</span> config : ?&#8288;name:string <span>&#45;&gt;</span> ?&#8288;state_repo:Uri.t <span>&#45;&gt;</span> ?&#8288;metrics_token:[ `SHA256 of string ] <span>&#45;&gt;</span> ?&#8288;listen_addr:[ `HTTP of int | `HTTPS of int ] <span>&#45;&gt;</span> ?&#8288;github_scopes_needed:Github_t.scope list <span>&#45;&gt;</span> can_read:<a href="../ACL/index.html#type-t">ACL.t</a> <span>&#45;&gt;</span> can_build:<a href="../ACL/index.html#type-t">ACL.t</a> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-config">config</a></code></dt><dd><p><code>config ~name ~state_repo ~can_read ~can_build ()</code> is a web configuration. If <code>name</code> is given, it is used as the main heading, and also as the name of the session cookie (useful if you run multiple CIs on the same host, on different ports). If <code>state_repo</code> is given, it is used to construct links to the state repository on GitHub. If <code>metrics_token</code> is <code>Some
      (`SHA256 expected)</code> given then doing an HTTP GET on <code>/metrics</code> with an Authorization header containing &quot;Bearer TTT&quot; will return Prometheus-format metrics if sha256(TTT) = expected. There is no rate limiting, so pick a long <code>token</code>. <code>github_scopes_needed</code> should be <code>`Read_org; `Public_repo</code> to check whether users can access a public repository, or <code>`Read_org, `Repo</code> to check access to private repos. Unfortunately, the GitHub API requires us to ask for far more permissions than we need.</p></dd></dl></section></div></body></html>